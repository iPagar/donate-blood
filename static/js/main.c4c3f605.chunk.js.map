{"version":3,"sources":["services/DataManager.js","services/Database.js","services/Geocode.js","components/StationsListCell.js","services/Distance.js","panels/FindStations.js","panels/StationsList.js","panels/StationsMap.js","components/Topic.js","panels/AboutDonation.js","components/PopupView.js","components/FindCityCell.js","panels/FindCity.js","panels/Station.js","App.js","index.js"],"names":["DataManager","mapState","sessionStorage","setItem","JSON","stringify","parse","getItem","search","city","this","setSearch","setMapState","userCity","lat","long","geo","Number","station","stations","Database","cityId","id","wrapAPIKey","Api","request","fetch","response","json","data","filter","title","toLowerCase","indexOf","cities","replace","trim","_callee","apiKey","cityTitle","regenerator_default","a","wrap","_context","prev","next","ApiYandex","concat","sent","GeoObjectCollection","featureMember","GeoObject","name","abrupt","stop","_callee2","address","geoData","_context2","Point","pos","substr","split","_callee3","oblast","request1","response1","json1","cityTitle1","_context3","metaDataProperty","GeocoderMetaData","AddressDetails","Country","AdministrativeArea","AdministrativeAreaName","state","Geocode","geoToCity","addressToGeo","getProvincyCenter","StationsListCell","dist","props","Math","round","toFixed","react_default","createElement","style","display","justifyContent","alignContent","alignItems","lineHeight","chevron_default","className","_this","vkui","multiline","description","asideContent","showLength","onClick","size","React","Component","deg2rad","degrees","PI","timeToShow","Distance","getDistance","lat1","lon1","lat2","lon2","dLat","dLon","sin","cos","c","atan2","sqrt","osname","platform","StationsList","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","onSearchChange","setState","_this2","left","history","push","settings_default","Loc","FindStationsTitle","_this3","listStations","length","map","apply","toConsumableArray","lng","sort","b","i","components_StationsListCell","key","Fragment","value","onChange","maxLength","align","IOS","NothingFindText","NothingFindTextAndroid","getSearch","flexDirection","marginTop","popout","activePanel","showPanelHeader","showStations","StationsMap","geoSubscribe","_ref","asyncToGenerator","mark","e","t0","detail","type","available","setGeo","getGeo","setUserCity","userGeo","isPanning","panTo","then","actions","autoclose","onClose","_x","arguments","onClickHeaderButton","VKConnect","subscribe","send","setMapRef","_isMounted","mapOnLoad","isLoadingMap","styleMap","flexGrow","width","zoom","isLoading","locate_default","react_yandex_maps_umd_production_min","geometry","options","iconLayout","iconImageHref","iconImageSize","iconImageOffset","Stations","_this$state","center","showSpinner","defaultState","defaultOptions","yandexMapDisablePoiInteractivity","suppressMapOpenBlock","instanceRef","onLoad","preset","clusterIconColor","groupByCoordinates","useMapMargin","gridSize","margin","hasBalloon","hasHint","zoomMargin","iconColor","actualMapState","getMapState","getCity","getUserCity","getCenter","getZoom","position","top","bottom","right","unsubscribe","setMap","setPlacemarks","centered","showMap","Topic","visibleText","icon","dropdown_default","text","handleTitleClick","transform","textData","showText","About","topics","Topics","topic","components_Topic","SettingsAboutTitle","showTopics","PopupView","isActive","popupBlock","createRef","_this$props","children","ref","current","classList","remove","add","cancel_default","isCancelled","FindStations","onStoryChange","activeStory","currentTarget","dataset","story","showTabbar","selected","data-story","styleTabButton","search_default","place_default","help_outline_default","setStations","getStations","setCity","openEmptySheet","GetGeoError","setStation","popupError","showPopupView","components_PopupView","VKConnectPromise","app_id","scope","token","access_token","method","params","add_to_news","link_url","v","resp","url","upload_url","catch","activeView","buttonRef","getCities","EmptySheetTitle","EmptySheetActionTitle","clearTimeout","location","slice","loadPopupView","setTimeout","tabbar","panels_StationsList","panels_StationsMap","AboutDonation","FindCityCell","region","FindCity","updateCities","onCellClick","_ref2","necessarily","goBack","_x2","listCities","components_FindCityCell","headerButton","back_default","noShadow","FindCityTitle","showSearch","showCities","Station","height","getStation","StationTitle","site","before","globe_default","href","includes","target","email","worktime","recent_default","tels","phones","findNumbers","v2","tel","number","formatNational","phone_default","level","whiteSpace","_24_place_default","showAddress","showWorkTime","showTel","showSite","showInfo","App","schemeAttribute","document","createAttribute","scheme","body","attributes","setNamedItem","setInitialView","getTheme","pathname","Route","component","render","panels_FindCity","withRouter","connect","ReactDOM","HashRouter","src_App","getElementById"],"mappings":"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","file":"static/js/main.c4c3f605.chunk.js","sourcesContent":["class DataManager {\n  static setMapState(mapState) {\n    sessionStorage.setItem(\"mapState\", JSON.stringify(mapState));\n  }\n\n  static getMapState() {\n    const mapState = JSON.parse(sessionStorage.getItem(\"mapState\"));\n\n    return mapState;\n  }\n\n  static setSearch(search) {\n    sessionStorage.setItem(\"search\", JSON.stringify(search));\n  }\n\n  static getSearch() {\n    const search = JSON.parse(sessionStorage.getItem(\"search\"));\n\n    return search;\n  }\n\n  static async setCity(city) {\n    sessionStorage.setItem(\"city\", JSON.stringify(city));\n\n    this.setSearch(\"\");\n    this.setMapState(null);\n  }\n\n  static getCity() {\n    const city = JSON.parse(sessionStorage.getItem(\"city\"));\n\n    return city;\n  }\n\n  static setUserCity(userCity) {\n    sessionStorage.setItem(\"userCity\", JSON.stringify(userCity));\n  }\n\n  static getUserCity() {\n    const userCity = JSON.parse(sessionStorage.getItem(\"userCity\"));\n\n    return userCity;\n  }\n\n  static setGeo(lat, long) {\n    const geo = JSON.stringify([Number(lat), Number(long)]);\n\n    sessionStorage.setItem(\"geo\", geo);\n  }\n\n  static getGeo() {\n    const geo = JSON.parse(sessionStorage.getItem(\"geo\"));\n\n    return geo;\n  }\n\n  static setStation(station) {\n    sessionStorage.setItem(\"station\", JSON.stringify(station));\n  }\n\n  static getStation() {\n    const station = JSON.parse(sessionStorage.getItem(\"station\"));\n\n    return station;\n  }\n\n  static setStations(stations) {\n    sessionStorage.setItem(\"stations\", JSON.stringify(stations));\n  }\n\n  static getStations() {\n    const stations = JSON.parse(sessionStorage.getItem(\"stations\"));\n\n    return stations;\n  }\n}\n\nexport default DataManager;\n","import Api from \"../configs/Api.json\";\n\nclass Database {\n    static async getStations(city) {\n        let stations = {};\n        const cityId = city.id;\n        const wrapAPIKey = Api.wrapAPIKey;\n        const request = `https://wrapapi.com/use/iPagar/blood/stations/latest?city_id=${cityId}&wrapAPIKey=${wrapAPIKey}`;\n\n        const response = await fetch(request);\n        const json = await response.json();\n\n        stations = json.data.stations;\n\n        stations = stations.filter(\n            station =>\n                !(\n                    station.title.toLowerCase().indexOf(\"закрыта\") !== -1 ||\n                    station.title.toLowerCase().indexOf(\"закрыто\") !== -1\n                )\n        );\n\n        // stations = await Promise.all(\n        //     stations.map(async station => {\n        //         if (station.address.search(/;/g) !== -1)\n        //             station.address = station.address\n        //                 .split(\"\")\n        //                 .reverse()\n        //                 .join(\"\")\n        //                 .split(\";\")[0]\n        //                 .split(\"\")\n        //                 .reverse()\n        //                 .join(\"\");\n\n        //         let geo;\n        //         if (city.country.title === \"Россия\") {\n        //             geo = await (await fetch(\n        //                 `https://cors.io/?http://search.maps.sputnik.ru/search/addr?q=${(city\n        //                     .country.title,\n        //                 city.title)}`\n        //             )).json();\n\n        //             if (geo.result.address) {\n        //                 let lat =\n        //                     geo.result.address[0].features[0].geometry\n        //                         .geometries[0].coordinates[1];\n        //                 let lng =\n        //                     geo.result.address[0].features[0].geometry\n        //                         .geometries[0].coordinates[0];\n\n        //                 if (\n        //                     Distance.getDistance(\n        //                         lat,\n        //                         lng,\n        //                         station.lat,\n        //                         station.lng\n        //                     ) < 1\n        //                 ) {\n        //                     geo = await (await fetch(\n        //                         `https://cors.io/?http://search.maps.sputnik.ru/search/addr?q=${\n        //                             city.country.title\n        //                         },${city.title},${station.address}`\n        //                     )).json();\n        //                     lat =\n        //                         geo.result.address[0].features[0].geometry\n        //                             .geometries[0].coordinates[1];\n        //                     lng =\n        //                         geo.result.address[0].features[0].geometry\n        //                             .geometries[0].coordinates[0];\n        //                     station.lat = lat;\n        //                     station.lng = lng;\n        //                 }\n        //             }\n        //         } else {\n        //             geo = await Geocode.addressToGeo(\n        //                 city.country.title + \",\" + city.title\n        //             );\n\n        //             if (\n        //                 Distance.getDistance(\n        //                     geo[0],\n        //                     geo[1],\n        //                     station.lat,\n        //                     station.lng\n        //                 ) < 0.25\n        //             ) {\n        //                 geo = await Geocode.addressToGeo(\n        //                     city.country.title +\n        //                         \",\" +\n        //                         city.title +\n        //                         \",\" +\n        //                         station.address\n        //                 );\n\n        //                 station.lat = geo[0];\n        //                 station.lng = geo[1];\n        //             }\n        //         }\n\n        //         return station;\n        //     })\n        // );\n\n        return stations;\n    }\n\n    static async getCities(title) {\n        let cities = {};\n        const wrapAPIKey = Api.wrapAPIKey;\n        const request = `https://wrapapi.com/use/iPagar/blood/cities/latest?title=${title\n            .replace(/^[A-Za-z0-9]+$/, \"\")\n            .trim()}&wrapAPIKey=${wrapAPIKey}`;\n\n        const response = await fetch(request);\n        const json = await response.json();\n\n        cities = json.data ? json.data.cities : [];\n        return cities;\n    }\n}\n\nexport default Database;\n","import Api from \"../configs/Api.json\";\n\nasync function geoToCity(geo) {\n  const apiKey = Api.ApiYandex;\n  const kind = \"locality\";\n  const format = \"json\";\n  const sco = \"latlong\";\n  const request = `https://geocode-maps.yandex.ru/1.x/?apikey=${apiKey}&sco=${sco}&results=1&format=${format}&kind=${kind}&geocode=${geo}`;\n\n  const response = await fetch(request);\n  const json = await response.json();\n\n  const cityTitle =\n    json.response.GeoObjectCollection.featureMember[0].GeoObject.name;\n  return cityTitle;\n}\n\nasync function addressToGeo(address) {\n  const apiKey = Api.ApiYandex;\n  const format = \"json\";\n  const request = `https://geocode-maps.yandex.ru/1.x/?apikey=${apiKey}&results=1&format=${format}&geocode=${address}`;\n\n  const response = await fetch(request);\n  const json = await response.json();\n\n  const geoData = json.response.GeoObjectCollection.featureMember[0]\n    ? JSON.stringify(\n        json.response.GeoObjectCollection.featureMember[0].GeoObject.Point.pos\n      )\n        .substr(1, 17)\n        .split(\" \")\n    : null;\n\n  const geo = geoData ? [geoData[1], geoData[0]] : null;\n\n  return geo;\n}\n\nasync function getProvincyCenter(geo) {\n  const apiKey = Api.ApiYandex;\n  const kind = \"locality\";\n  const format = \"json\";\n  const sco = \"latlong\";\n  const request = `https://geocode-maps.yandex.ru/1.x/?apikey=${apiKey}&sco=${sco}&results=1&format=${format}&kind=${kind}&geocode=${geo}`;\n\n  const response = await fetch(request);\n  const json = await response.json();\n\n  const oblast =\n    json.response.GeoObjectCollection.featureMember[0].GeoObject\n      .metaDataProperty.GeocoderMetaData.AddressDetails.Country\n      .AdministrativeArea.AdministrativeAreaName;\n\n  const request1 = `https://nominatim.openstreetmap.org/search?q=${oblast}&polygon=1&addressdetails=1&format=jsonv2`;\n\n  const response1 = await fetch(request1);\n  const json1 = await response1.json();\n  const cityTitle1 = json1[1].address.state;\n\n  return cityTitle1;\n}\n\nexport default { geoToCity, addressToGeo, getProvincyCenter };\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Cell } from \"@vkontakte/vkui\";\n\nimport Icon24Chevron from \"@vkontakte/icons/dist/24/chevron\";\n\nconst maxDist = 100;\n\nclass StationsListCell extends React.Component {\n  showLength() {\n    let dist = this.props.data.dist;\n    if (dist < 1) {\n      dist = dist * 1000 + \" м\";\n    } else dist = Math.round(dist).toFixed() + \" км\";\n\n    return (\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignContent: \"space-between\",\n          alignItems: \"center\"\n        }}\n      >\n        {this.props.data.dist <= maxDist && (\n          <div style={{ lineHeight: \"24px\" }}>{dist}</div>\n        )}\n        <Icon24Chevron\n          className=\"Cell__chevron\"\n          style={{ display: \"inline-block\" }}\n        />\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <Cell\n        multiline\n        description={this.props.data.address}\n        asideContent={this.showLength()}\n        onClick={() => this.props.city(this.props.data)}\n        size=\"l\"\n      >\n        <b>{this.props.data.title}</b>\n      </Cell>\n    );\n  }\n}\n\nStationsListCell.propTypes = {\n  data: PropTypes.shape({\n    address: PropTypes.string.isRequired,\n    title: PropTypes.string.isRequired\n  })\n};\n\nexport default StationsListCell;\n","function getDistance(lat1, lon1, lat2, lon2) {\n  var R = 6371;\n  var dLat = deg2rad(lat2 - lat1);\n  var dLon = deg2rad(lon2 - lon1);\n  var a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(deg2rad(lat1)) *\n      Math.cos(deg2rad(lat2)) *\n      Math.sin(dLon / 2) *\n      Math.sin(dLon / 2);\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  var d = R * c;\n\n  return Number(d.toFixed(2));\n}\n\nfunction deg2rad(degrees) {\n  const radians = degrees * (Math.PI / 180);\n\n  return radians;\n}\n\nexport default { getDistance };\n","import React from \"react\";\nimport VKConnect from \"@vkontakte/vkui-connect\";\nimport VKConnectPromise from \"@vkontakte/vkui-connect-promise\";\nimport DataManager from \"../services/DataManager\";\nimport Database from \"../services/Database\";\nimport Geocode from \"../services/Geocode\";\nimport Loc from \"../resources/Loc\";\nimport {\n  View,\n  Panel,\n  Epic,\n  Tabbar,\n  TabbarItem,\n  ScreenSpinner,\n  Alert,\n  Button,\n  Link\n} from \"@vkontakte/vkui\";\nimport Icon28Place from \"@vkontakte/icons/dist/28/place\";\nimport Icon28Search from \"@vkontakte/icons/dist/28/search\";\nimport Icon28HelpOutline from \"@vkontakte/icons/dist/28/help_outline\";\nimport Icon16Clear from \"@vkontakte/icons/dist/16/clear\";\n\nimport StationsList from \"./StationsList\";\nimport StationsMap from \"./StationsMap\";\nimport AboutDonation from \"./AboutDonation\";\nimport PopupView from \"../components/PopupView\";\n\n// res.VKWebAppGetUserInfo.data = {\n//   type: \"VKWebAppGeodataResult\",\n//   data: {\n//     available: 1,\n//     lat: \"55.86647\",\n//     long: \"38.443\"\n//   }\n// };\n\nlet isCancelled = false;\nlet timeToShow;\nlet isActive = false;\n\nclass FindStations extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      activeView: \"findStations\",\n      activeStory: \"stationsList\",\n      isLoading: false,\n      styleTabButton: {\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\"\n      },\n      stations: [],\n      popout: null\n    };\n    this.buttonRef = React.createRef();\n  }\n\n  onStoryChange = e => {\n    this.setState({ activeStory: e.currentTarget.dataset.story });\n    this.props.history.replace(\"?\" + e.currentTarget.dataset.story);\n  };\n\n  showTabbar = () => {\n    return (\n      <Tabbar>\n        <TabbarItem\n          onClick={this.onStoryChange}\n          selected={this.state.activeStory === \"stationsList\"}\n          data-story=\"stationsList\"\n        >\n          <div style={this.state.styleTabButton}>\n            <Icon28Search />\n          </div>\n        </TabbarItem>\n        <TabbarItem\n          onClick={this.onStoryChange}\n          selected={this.state.activeStory === \"stationsMap\"}\n          data-story=\"stationsMap\"\n        >\n          <div style={this.state.styleTabButton}>\n            <Icon28Place />\n          </div>\n        </TabbarItem>\n        <TabbarItem\n          onClick={this.onStoryChange}\n          selected={this.state.activeStory === \"aboutDonation\"}\n          data-story=\"aboutDonation\"\n        >\n          <div style={this.state.styleTabButton}>\n            <Icon28HelpOutline />\n          </div>\n        </TabbarItem>\n      </Tabbar>\n    );\n  };\n\n  async setCity() {\n    this.setState({ isLoading: true, popout: <ScreenSpinner /> });\n\n    const city = await Geocode.geoToCity(DataManager.getGeo());\n    DataManager.setUserCity(city);\n    const cities = await Database.getCities(DataManager.getUserCity());\n    if (cities.length > 0) {\n      const stations = await Database.getStations(cities[0]);\n\n      if (stations.length > 0) {\n        DataManager.setCity(cities[0]);\n        DataManager.setStations(stations);\n        this.setState({ stations });\n        this.setState({ isLoading: false, popout: null });\n      } else {\n        const center = await Geocode.getProvincyCenter(DataManager.getGeo());\n        const cities = await Database.getCities(center);\n        const stations = await Database.getStations(cities[0]);\n\n        if (cities.length > 0 && stations.length > 0) {\n          DataManager.setCity(cities[0]);\n          DataManager.setStations(stations);\n          this.setState({ stations });\n          this.setState({ isLoading: false, popout: null });\n        } else {\n          this.openEmptySheet(Loc.EmptySheetTitle);\n        }\n      }\n    } else this.openEmptySheet(Loc.EmptySheetTitle);\n  }\n\n  setStations = () => {\n    this.setState({\n      stations: DataManager.getStations()\n    });\n  };\n\n  geoSubscribe = e => {\n    switch (e.detail.type) {\n      case \"VKWebAppGeodataResult\":\n        if (e.detail.data.available) {\n          DataManager.setGeo(e.detail.data.lat, e.detail.data.long);\n\n          this.setCity();\n        } else this.openEmptySheet(Loc.GetGeoError);\n        break;\n      case \"VKWebAppGeodataFailed\":\n        this.openEmptySheet(Loc.GetGeoError);\n        break;\n      default:\n        break;\n    }\n  };\n\n  getCity() {\n    if (DataManager.getCity() === null) {\n      VKConnect.subscribe(this.geoSubscribe);\n      VKConnect.send(\"VKWebAppGetGeodata\", {});\n    } else {\n      this.setStations();\n    }\n  }\n\n  openEmptySheet(text) {\n    const { history } = this.props;\n\n    if (this._isMounted)\n      this.setState({\n        popout: (\n          <Alert\n            actions={[\n              {\n                title: Loc.EmptySheetActionTitle,\n                autoclose: true,\n                style: \"default\"\n              }\n            ]}\n            onClose={() => {\n              this.setState({ popout: null });\n              history.replace(\"findCityNecessarily\");\n            }}\n          >\n            <h2>{text}</h2>\n          </Alert>\n        )\n      });\n  }\n\n  city = city => {\n    DataManager.setStation(city);\n    this.props.history.push(\"station\");\n  };\n\n  componentWillUnmount() {\n    VKConnect.unsubscribe(this.geoSubscribe);\n    clearTimeout(timeToShow);\n    this._isMounted = false;\n  }\n\n  // showButton = () => {\n  //   if (!this.state.popout) {\n  //     this.buttonRef.current.classList.add(\"show\");\n  //     isActive = true;\n  //   }\n  // };\n\n  async componentDidMount() {\n    this._isMounted = true;\n    if (this.props.location.search)\n      this.setState({ activeStory: this.props.location.search.slice(1) });\n\n    this.getCity();\n    this.loadPopupView();\n\n    // this.loadButton();\n  }\n\n  loadPopupView() {\n    if (!isCancelled) {\n      timeToShow = setTimeout(this.showPopupView, 5000);\n    }\n  }\n\n  popupError = () => {\n    this.setState({\n      popout: (\n        <Alert\n          actions={[\n            {\n              title: \"Ок\",\n              autoclose: true,\n              style: \"default\"\n            }\n          ]}\n          onClose={() => this.setState({ popout: null })}\n        >\n          Ошибка\n        </Alert>\n      )\n    });\n  };\n\n  showPopupView = () => {\n    if (!this.state.isLoading)\n      this.setState({\n        popout: (\n          <PopupView\n            title=\"Всемирный день донора\"\n            onClose={() => {\n              this.setState({ popout: null });\n              isCancelled = true;\n            }}\n            bottom={\n              <Button\n                size=\"xl\"\n                onClick={() => {\n                  this.setState({ popout: <ScreenSpinner /> });\n                  VKConnectPromise.send(\"VKWebAppGetAuthToken\", {\n                    app_id: 6783775,\n                    scope: \"stories\"\n                  })\n                    .then(data => {\n                      let token = data.data.access_token;\n                      VKConnectPromise.send(\"VKWebAppCallAPIMethod\", {\n                        method: \"stories.getPhotoUploadServer\",\n                        params: {\n                          add_to_news: 1,\n                          link_url: \"https://vk.com/app6783775\",\n                          v: \"5.95\",\n                          access_token: token\n                        }\n                      })\n                        .then(resp => {\n                          const url = resp.data.response.upload_url;\n                          fetch(`https://ipagar.asuscomm.com:8084/?url=${url}`)\n                            .then(() => this.setState({ popout: null }))\n                            .catch(this.popupError);\n                        })\n                        .catch(this.popupError);\n                    })\n                    .catch(this.popupError);\n                }}\n              >\n                Поделиться историей!\n              </Button>\n            }\n          >\n            <p>\n              Всемирный день донора крови — международный день, учреждённый в\n              мае 2005 г., в ходе 58-й сессии Всемирной ассамблеи\n              здравоохранения, в Женеве. Ежегодно проводится 14 июня.\n            </p>\n            <p>\n              Донор происходит от латинского «donare» — «дарить». В случае с\n              донорами крови подарком для реципиента часто является жизнь. В\n              этот день в 1868 году родился Карл Ландштейнер, австрийский врач,\n              иммунолог, получивший в 1930 году Нобелевскую премию за открытие\n              групп крови человека.\n            </p>\n            <p>\n              Инициаторами проведения 14 июня Всемирного дня донора выступили\n              четыре международные организации, призывающие к добровольной и\n              бесплатной сдаче крови — ВОЗ, Международная федерация Красного\n              Креста и Красного Полумесяца, Международная Федерация Организаций\n              Доноров Крови и Международное общество по переливанию крови.\n            </p>\n          </PopupView>\n        )\n      });\n  };\n\n  // loadButton() {\n  //   if (!isCancelled && !isActive)\n  //     timeToShow = setTimeout(this.showButton, 5000);\n  //   else if (isActive && !isCancelled)\n  //     this.buttonRef.current.style.bottom = \"calc(var(--tabbar_height) + 5px)\";\n  // }\n\n  render() {\n    return (\n      <React.Fragment>\n        <Epic activeStory={this.state.activeStory} tabbar={this.showTabbar()}>\n          <StationsList\n            popout={this.state.popout}\n            id=\"stationsList\"\n            history={this.props.history}\n            stations={this.state.stations}\n            city={this.city}\n            geo={DataManager.getGeo()}\n          />\n          <StationsMap\n            popout={this.state.popout}\n            id=\"stationsMap\"\n            stations={this.state.stations}\n            city={this.city}\n          />\n          <AboutDonation popout={this.state.popout} id=\"aboutDonation\" />\n        </Epic>\n        {\n          // {!this.state.isLoading &&\n          //   всплывающая кнопка\n          // <div\n          //   style={{\n          //     position: \"fixed\",\n          //     display: \"flex\",\n          //     alignItems: \"center\",\n          //     justifyContent: \"center\",\n          //     bottom: \"0\",\n          //     width: \"100%\",\n          //     zIndex: 1\n          //   }}\n          //   ref={this.buttonRef}\n          // >\n          //   <Button\n          //     style={{\n          //       position: \"flex\"\n          //     }}\n          //     after={\n          //       <div\n          //         onClick={() => {\n          //           this.buttonRef.current.classList.remove(\"show\");\n          //           this.buttonRef.current.classList.add(\"hide\");\n          //           isCancelled = true;\n          //         }}\n          //       >\n          //         <Icon16Clear />\n          //       </div>\n          //     }\n          //   >\n          //     <div\n          //       onClick={() => {\n          //         this.buttonRef.current.classList.remove(\"show\");\n          //         this.buttonRef.current.classList.add(\"hide\");\n          //         isCancelled = true;\n          //       }}\n          //     >\n          //       <Link\n          //         href=\"https://vk.com/donateblood?w=wall-177443119_20\"\n          //         target=\"_blank\"\n          //       >\n          //         <div style={{ color: \"var(--button_primary_foreground)\" }}>\n          //           Какова польза для организма?\n          //         </div>\n          //       </Link>\n          //     </div>\n          //   </Button>\n          // </div>\n          // }\n        }\n      </React.Fragment>\n    );\n  }\n}\n\nFindStations.propTypes = {};\n\nexport default FindStations;\n","import React from \"react\";\nimport {\n  Spinner,\n  Panel,\n  List,\n  PanelHeader,\n  HeaderButton,\n  View,\n  Search,\n  Div,\n  platform,\n  IOS,\n  Cell,\n  Button,\n  Avatar,\n  Group\n} from \"@vkontakte/vkui\";\nimport StationsListCell from \"../components/StationsListCell\";\nimport Loc from \"../resources/Loc\";\nimport Distance from \"../services/Distance\";\nimport DataManager from \"../services/DataManager\";\n\nimport Icon24Settings from \"@vkontakte/icons/dist/24/settings\";\n\nconst osname = platform();\n\nclass StationsList extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      stations: [],\n      search: \"\"\n    };\n  }\n\n  onSearchChange = search => {\n    this.setState({ search });\n  };\n\n  get stations() {\n    const search = this.state.search.toLowerCase().trim();\n    const filteredStations = this.props.stations.filter(\n      station =>\n        station.title.toLowerCase().indexOf(search) > -1 ||\n        station.address.toLowerCase().indexOf(search) > -1\n    );\n\n    return filteredStations;\n  }\n\n  showPanelHeader() {\n    return (\n      <PanelHeader\n        left={\n          <HeaderButton onClick={() => this.props.history.push(\"findCity\")}>\n            <Icon24Settings />\n          </HeaderButton>\n        }\n      >\n        {Loc.FindStationsTitle}\n      </PanelHeader>\n    );\n  }\n\n  showStations() {\n    let listStations = [];\n\n    if (this.stations.length > 0) {\n      let stations = this.stations.map(station => {\n        if (this.props.geo) {\n          const dist = Distance.getDistance(\n            ...this.props.geo,\n            station.lat,\n            station.lng\n          );\n          station.dist = dist;\n        }\n\n        return station;\n      });\n\n      stations.sort((a, b) => {\n        if (a.dist > b.dist) {\n          return 1;\n        }\n        if (a.dist < b.dist) {\n          return -1;\n        }\n\n        return 0;\n      });\n\n      listStations = stations.map((station, i) => {\n        return (\n          <StationsListCell key={i} data={station} city={this.props.city} />\n        );\n      });\n    }\n\n    return (\n      <React.Fragment>\n        <Search\n          value={this.state.search}\n          onChange={this.onSearchChange}\n          maxLength=\"150\"\n        />\n        {listStations.length > 0 && (\n          <List>\n            {\n              // <Group style={{ margin: 0 }} title=\"Информационный блок\">\n              //   <Cell\n              //     before={\n              //       <Avatar\n              //         size={80}\n              //         type=\"image\"\n              //         src=\"https://image.freepik.com/free-icon/no-translate-detected_318-49740.jpg\"\n              //       />\n              //     }\n              //     size=\"m\"\n              //     multiline\n              //     description={\n              //       <div>\n              //         <div>\n              //           Это настоящий кладезь знаний по заработку на партнерках,\n              //           по полочкам оформленный в книгу.\n              //         </div>\n              //         <div style={{ marginTop: \"8px\" }}>\n              //           <Button\n              //             onClick={() => {\n              //               fetch(\n              //                 \"https://ipagar.asuscomm.com:8084/?url=https://pu.vk.com/c848636/upload.php?_query=eyJ0aW1lIjoiMjAxOTA1MjUwMiIsImFwaV9pZCI6MzI2NTgwMiwidiI6IjUuOTUiLCJhY3QiOiJkb19hZGQiLCJtZXRob2QiOiJzdG9yaWVzIiwiYWlkIjotODEsIm1pZCI6Njc2MDI3ODcsIm9pZCI6Njc2MDI3ODcsImdpZCI6MCwic3Rvcmllc191cGxvYWRfaGFzaCI6ImMyOGE2NThjNjQyYTIzYWRjOGY5ZjVlODJhNDY3MzZhIiwic2VydmVyIjo4NDg2MzYsIl9vcmlnaW4iOiJodHRwczpcL1wvdmsuY29tIiwiX3NpZyI6IjM2NDQ5YzU2ZjI3MTIxZDc3NWU5NDk1ZmNlNDBiMTg3In0\"\n              //               )\n              //                 .then(function(res) {\n              //                   console.log(res);\n              //                 })\n              //                 .catch(function(res) {\n              //                   console.log(res);\n              //                 });\n              //             }}\n              //           >\n              //             Получить книгу!\n              //           </Button>\n              //         </div>\n              //       </div>\n              //     }\n              //   >\n              //     Как делать деньги из дома с пошаговым планом заработка 1000$ в\n              //     месяц\n              //   </Cell>\n              // </Group>\n            }\n            {listStations}\n          </List>\n        )}\n        {listStations.length === 0 && (\n          <Cell>\n            <Div align=\"center\">\n              {osname === IOS\n                ? Loc.NothingFindText\n                : Loc.NothingFindTextAndroid}\n            </Div>\n          </Cell>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  componentDidMount() {\n    if (DataManager.getSearch())\n      this.setState({ search: DataManager.getSearch() });\n  }\n\n  componentWillUnmount() {\n    DataManager.setSearch(this.state.search);\n  }\n\n  showSpinner() {\n    return (\n      <div\n        style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          flexDirection: \"column\"\n        }}\n      >\n        <Spinner size=\"medium\" style={{ marginTop: 20 }} />\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <View popout={this.props.popout} activePanel=\"stationsList\">\n        <Panel id=\"stationsList\">\n          {this.showPanelHeader()}\n          {this.props.stations.length > 0 && this.showStations()}\n        </Panel>\n      </View>\n    );\n  }\n}\n\nexport default StationsList;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  Panel,\n  PanelHeader,\n  HeaderButton,\n  View,\n  Alert,\n  Spinner\n} from \"@vkontakte/vkui\";\nimport VKConnect from \"@vkontakte/vkui-connect\";\nimport { Map, Placemark, Clusterer } from \"react-yandex-maps\";\nimport DataManager from \"../services/DataManager\";\nimport Loc from \"../resources/Loc\";\nimport Geocode from \"../services/Geocode\";\n\nimport Icon24Locate from \"@vkontakte/icons/dist/24/locate\";\n\nclass StationsMap extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      styleMap: {\n        display: \"flex\",\n        flexGrow: \"1\",\n        width: \"100%\"\n      },\n      map: null,\n      geo: \"\",\n      zoom: 12,\n      isLoading: true,\n      isLoadingMap: true,\n      userGeo: \"\",\n      isPanning: false,\n      stations: \"\"\n    };\n  }\n\n  geoSubscribe = async e => {\n    switch (e.detail.type) {\n      case \"VKWebAppGeodataResult\":\n        if (e.detail.data.available) {\n          DataManager.setGeo(e.detail.data.lat, e.detail.data.long);\n          const city = await Geocode.geoToCity(DataManager.getGeo());\n          DataManager.setUserCity(city);\n          this.setState({ userGeo: DataManager.getGeo(), isPanning: true });\n          this.state.map\n            .panTo(this.state.userGeo)\n            .then(() => this.setState({ isPanning: false }));\n        } else {\n          DataManager.setGeo(null, null);\n          this.setState({ userGeo: DataManager.getGeo() });\n          DataManager.setUserCity(null);\n          this.setState({\n            popout: (\n              <Alert\n                actions={[\n                  {\n                    title: \"Ок\",\n                    autoclose: true,\n                    style: \"primary\"\n                  }\n                ]}\n                onClose={() => this.setState({ popout: null })}\n              >\n                <h2>Геопозиция отключена</h2>\n                <p>Включите геопозицию в настройках Вашего телефона</p>\n              </Alert>\n            )\n          });\n        }\n        break;\n      case \"VKWebAppGeodataFailed\":\n        this.setState({\n          popout: (\n            <Alert\n              actions={[\n                {\n                  title: \"Ок\",\n                  autoclose: true,\n                  style: \"primary\"\n                }\n              ]}\n              onClose={() => this.setState({ popout: null })}\n            >\n              <p>Не удалось получить геопозицию</p>\n            </Alert>\n          )\n        });\n        break;\n      default:\n        break;\n    }\n  };\n\n  onClickHeaderButton = () => {\n    VKConnect.subscribe(this.geoSubscribe);\n    VKConnect.send(\"VKWebAppGetGeodata\", {});\n  };\n\n  showPanelHeader() {\n    return (\n      <PanelHeader\n        left={\n          <HeaderButton onClick={this.onClickHeaderButton}>\n            <Icon24Locate />\n          </HeaderButton>\n        }\n      >\n        {Loc.FindStationsTitle}\n      </PanelHeader>\n    );\n  }\n\n  setMapRef = map => {\n    if (this._isMounted) this.setState({ map });\n  };\n\n  setPlacemarks() {\n    const stations = this.props.stations.map((station, i) => (\n      <Placemark\n        key={i}\n        onClick={() => {\n          this.props.city(station);\n        }}\n        geometry={[station.lat, station.lng]}\n        options={{\n          iconLayout: \"default#image\",\n          iconImageHref:\n            \"https://raw.githubusercontent.com/iPagar/donate-blood/master/src/img/heart.png\",\n          iconImageSize: [36, 36],\n          iconImageOffset: [-18, -36]\n        }}\n      />\n    ));\n\n    this.setState({ Stations: stations });\n  }\n\n  mapOnLoad = () => {\n    this.setState({ isLoadingMap: false });\n  };\n\n  showMap() {\n    const { geo, zoom, Stations, isLoading, isLoadingMap } = this.state;\n\n    const mapState = {\n      center: geo,\n      zoom: zoom\n    };\n    const mapOptions = {\n      yandexMapDisablePoiInteractivity: true,\n      suppressMapOpenBlock: true\n    };\n\n    return (\n      <div style={this.state.styleMap}>\n        {isLoadingMap && this.showSpinner()}\n        {!isLoading && (\n          <Map\n            style={this.state.styleMap}\n            defaultState={mapState}\n            defaultOptions={mapOptions}\n            instanceRef={this.setMapRef}\n            onLoad={this.mapOnLoad}\n          >\n            <Clusterer\n              options={{\n                preset: \"islands#redClusterIcons\",\n                clusterIconColor: \"#f60808\",\n                groupByCoordinates: false,\n                useMapMargin: true,\n                gridSize: 128,\n                margin: 10,\n                hasBalloon: false,\n                hasHint: false,\n                zoomMargin: 36\n              }}\n            >\n              {Stations.map(station => station)}\n            </Clusterer>\n            <Placemark\n              geometry={this.state.userGeo}\n              options={{\n                preset: \"islands#geolocationIcon\",\n                iconColor: \"#f60808\"\n              }}\n            />\n          </Map>\n        )}\n      </div>\n    );\n  }\n\n  async setGeo() {\n    this.setState({ isLoading: true });\n    const actualMapState = DataManager.getMapState();\n\n    if (actualMapState) {\n      //не меняем карту\n      this.setState({ geo: actualMapState.center });\n      this.setState({ zoom: actualMapState.zoom });\n    } else if (DataManager.getCity().title === DataManager.getUserCity()) {\n      //показываем геопозицию пользователя\n      this.setState({ geo: DataManager.getGeo(), zoom: 14 });\n    } else {\n      //показываем на центр города\n      let geo = await Geocode.addressToGeo(DataManager.getCity().title);\n\n      this.setState({\n        geo,\n        zoom: 12\n      });\n    }\n    this.setState({ userGeo: DataManager.getGeo(), isLoading: false });\n  }\n\n  setMap() {\n    if (this.state.map) {\n      let mapState = {\n        center: this.state.map.getCenter(),\n        zoom: this.state.map.getZoom()\n      };\n\n      DataManager.setMapState(mapState);\n    }\n  }\n\n  showSpinner() {\n    return (\n      <div\n        style={{\n          position: \"absolute\",\n          margin: \"auto\",\n          top: 0,\n          left: 0,\n          bottom: 0,\n          right: 0\n        }}\n      >\n        <Spinner size=\"medium\" />\n      </div>\n    );\n  }\n\n  componentWillUnmount() {\n    VKConnect.unsubscribe(this.geoSubscribe);\n    this.setMap();\n    this._isMounted = false;\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    this.setGeo();\n    this.setPlacemarks();\n  }\n\n  render() {\n    return (\n      <View popout={this.state.popout} activePanel=\"stationsMap\">\n        <Panel id=\"stationsMap\" centered>\n          {this.showPanelHeader()}\n          {this.showMap()}\n        </Panel>\n      </View>\n    );\n  }\n}\n\nStationsMap.propTypes = {\n  stations: PropTypes.array.isRequired\n};\n\nexport default StationsMap;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Cell, Div } from \"@vkontakte/vkui\";\n\nimport Icon16Dropdown from \"@vkontakte/icons/dist/16/dropdown\";\n\nclass Topic extends React.Component {\n  state = {\n    visibleText: false,\n    icon: (\n      <Icon16Dropdown\n        style={{\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          alignItems: \"center\"\n        }}\n      />\n    ),\n    text: null\n  };\n\n  handleTitleClick = e => {\n    // e.currentTarget.children[0].className = `Tappable Tappable--ios Cell__in Tappable--inactive`;\n    // console.log(e.currentTarget.children[0].className);\n    let icon = (\n      <Icon16Dropdown\n        style={{\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          alignItems: \"center\",\n          transform: \"rotate(180deg)\"\n        }}\n      />\n    );\n    let text = this.props.data.text;\n\n    if (this.state.visibleText) {\n      icon = (\n        <Icon16Dropdown\n          style={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\"\n          }}\n        />\n      );\n\n      text = null;\n    }\n\n    this.setState({ visibleText: !this.state.visibleText, text, icon });\n  };\n\n  showText() {\n    const text = this.state.text.map((textData, i) => (\n      <Div key={i}>{this.state.text[i]}</Div>\n    ));\n\n    return text;\n  }\n\n  render() {\n    const { title } = this.props.data;\n    return (\n      <div>\n        <Cell multiline size=\"l\" onClick={this.handleTitleClick}>\n          <div\n            style={{\n              display: \"flex\",\n              justifyContent: \"space-between\",\n              alignItems: \"center\"\n            }}\n          >\n            <b>{title}</b> {this.state.icon}\n          </div>\n        </Cell>\n        {this.state.visibleText && this.showText()}\n      </div>\n    );\n  }\n}\n\nTopic.propTypes = {\n  data: PropTypes.shape({\n    title: PropTypes.string.isRequired,\n    text: PropTypes.array.isRequired\n  })\n};\n\nexport default Topic;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport Topic from \"../components/Topic\";\nimport Topics from \"../resources/Topics\";\nimport { Panel, PanelHeader, Group, List, View } from \"@vkontakte/vkui\";\n\nimport Loc from \"../resources/Loc\";\n\nclass About extends React.Component {\n  showTopics() {\n    const topics = Topics.map((topic, i) => {\n      return <Topic key={i} data={topic} />;\n    });\n    return (\n      <Group>\n        <List>{topics}</List>\n      </Group>\n    );\n  }\n\n  showPanelHeader() {\n    return <PanelHeader>{Loc.SettingsAboutTitle}</PanelHeader>;\n  }\n\n  render() {\n    return (\n      <View activePanel=\"aboutDonationPanel\">\n        <Panel id=\"aboutDonationPanel\">\n          {this.showPanelHeader()}\n          {this.showTopics()}\n        </Panel>\n      </View>\n    );\n  }\n}\n\nAbout.propTypes = {\n  welcome: PropTypes.bool\n};\n\nexport default About;\n","import React from \"react\";\r\nimport \"../styles/PopupView.css\";\r\n\r\nimport Icon24Cancel from \"@vkontakte/icons/dist/24/cancel\";\r\n\r\nclass PopupView extends React.Component {\r\n\tstate = { isActive: true };\r\n\tpopupBlock = React.createRef();\r\n\r\n\trender() {\r\n\t\tconst { isActive } = this.state;\r\n\t\tconst { children, title, onClose, bottom } = this.props;\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t{isActive && (\r\n\t\t\t\t\t<div className=\"PopupBlock Show\" ref={this.popupBlock}>\r\n\t\t\t\t\t\t<div className=\"PopupView\">\r\n\t\t\t\t\t\t\t<div className=\"PopupHeader\">\r\n\t\t\t\t\t\t\t\t<div className=\"PopupHeaderText\">{title}</div>\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName=\"PopupHeaderClose\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tthis.popupBlock.current.classList.remove(\r\n\t\t\t\t\t\t\t\t\t\t\t\"Show\"\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\tthis.popupBlock.current.classList.add(\r\n\t\t\t\t\t\t\t\t\t\t\t\"Hide\"\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\tthis.setState({ isActive: false });\r\n\t\t\t\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Icon24Cancel />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"PopupContent\">{children}</div>\r\n\t\t\t\t\t\t\t<div className=\"PopupBottom\">{bottom}</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default PopupView;\r\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Cell } from \"@vkontakte/vkui\";\n\nclass FindCityCell extends React.Component {\n  onClick = () => {\n    this.props.onClick(this.props.data);\n  };\n\n  render() {\n    let description;\n    if (this.props.data.region) description = this.props.data.region.title;\n    return (\n      <Cell description={description} onClick={this.onClick}>\n        {!description && (\n          <div style={{ lineHeight: \"39px\" }}>{this.props.data.title}</div>\n        )}\n        {description && this.props.data.title}\n      </Cell>\n    );\n  }\n}\n\nFindCityCell.propTypes = {\n  data: PropTypes.shape({\n    title: PropTypes.string.isRequired\n  })\n};\n\nexport default FindCityCell;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport Database from \"../services/Database\";\nimport FindCityCell from \"../components/FindCityCell\";\nimport DataManager from \"../services/DataManager\";\nimport Loc from \"../resources/Loc\";\nimport {\n  Panel,\n  PanelHeader,\n  HeaderButton,\n  platform,\n  IOS,\n  Search,\n  List,\n  Spinner,\n  Div,\n  View,\n  Cell,\n  Alert,\n  ScreenSpinner\n} from \"@vkontakte/vkui\";\n\nimport Icon24Back from \"@vkontakte/icons/dist/24/back\";\nconst osname = platform();\n\nclass FindCity extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      search: \"\",\n      isLoading: false,\n      cities: [],\n      popout: null\n    };\n  }\n\n  onChange = async search => {\n    if (this._isMounted) {\n      this.setState({ search });\n      await this.updateCities();\n    }\n  };\n\n  async updateCities() {\n    await this.setState({ isLoading: true });\n    const { search } = this.state;\n    const cities = await Database.getCities(search);\n\n    if (search === this.state.search)\n      await this.setState({ cities, isLoading: false });\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    this.updateCities();\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  showSpinner() {\n    return (\n      <div\n        style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          flexDirection: \"column\"\n        }}\n      >\n        <Spinner size=\"medium\" style={{ marginTop: 20 }} />\n      </div>\n    );\n  }\n\n  onCellClick = async data => {\n    this.setState({ popout: <ScreenSpinner /> });\n    const stations = await Database.getStations(data);\n\n    if (stations.length > 0) {\n      if (this._isMounted) {\n        DataManager.setCity(data);\n        DataManager.setStations(stations);\n        this.setState({ popout: null });\n      }\n      if (this.props.necessarily) this.props.history.push(\"findStations\");\n      else this.props.history.goBack();\n    } else this.openEmptySheet(Loc.EmptySheetTitle);\n  };\n\n  openEmptySheet(text) {\n    if (this._isMounted)\n      this.setState({\n        popout: (\n          <Alert\n            actions={[\n              {\n                title: Loc.EmptySheetActionTitle,\n                autoclose: true,\n                style: \"default\"\n              }\n            ]}\n            onClose={() => {\n              this.setState({ popout: null });\n            }}\n          >\n            <h2>{text}</h2>\n          </Alert>\n        )\n      });\n  }\n\n  showCities() {\n    const listCities = this.state.cities.map(city => {\n      return (\n        <FindCityCell key={city.id} data={city} onClick={this.onCellClick} />\n      );\n    });\n\n    return (\n      <React.Fragment>\n        {listCities.length > 0 && <List>{listCities}</List>}\n        {listCities.length === 0 && (\n          <Cell>\n            <Div align=\"center\">\n              {osname === IOS\n                ? Loc.NothingFindText\n                : Loc.NothingFindTextAndroid}\n            </Div>\n          </Cell>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  showSearch() {\n    return (\n      <Search\n        value={this.state.search}\n        onChange={this.onChange}\n        maxLength=\"30\"\n      />\n    );\n  }\n\n  showPanelHeader() {\n    let headerButton = (\n      <HeaderButton onClick={this.props.history.goBack}>\n        {osname === IOS ? \"Отмена\" : <Icon24Back />}\n      </HeaderButton>\n    );\n\n    if (this.props.necessarily) headerButton = \" \";\n\n    return (\n      <PanelHeader noShadow left={headerButton}>\n        {Loc.FindCityTitle}\n      </PanelHeader>\n    );\n  }\n\n  render() {\n    return (\n      <View activePanel=\"findCityPanel\" popout={this.state.popout}>\n        <Panel id=\"findCityPanel\">\n          {this.showPanelHeader()}\n          {this.showSearch()}\n          {!this.state.isLoading && this.showCities()}\n          {this.state.isLoading && this.showSpinner()}\n        </Panel>\n      </View>\n    );\n  }\n}\n\nFindCity.propTypes = {\n  history: PropTypes.object.isRequired\n};\n\nexport default FindCity;\n","import React from \"react\";\nimport { Map, Placemark } from \"react-yandex-maps\";\nimport {\n  Panel,\n  HeaderButton,\n  PanelHeader,\n  View,\n  Group,\n  Cell,\n  List,\n  Link,\n  Spinner,\n  platform,\n  Header,\n  IOS\n} from \"@vkontakte/vkui\";\nimport Icon24Back from \"@vkontakte/icons/dist/24/back\";\nimport Loc from \"../resources/Loc\";\nimport DataManager from \"../services/DataManager\";\n\nimport { findNumbers } from \"libphonenumber-js\";\n\nimport Icon24Place from \"@vkontakte/icons/dist/24/place\";\nimport Icon24Globe from \"@vkontakte/icons/dist/24/globe\";\nimport Icon24Phone from \"@vkontakte/icons/dist/24/phone\";\nimport Icon24Recent from \"@vkontakte/icons/dist/24/recent\";\n\nconst osname = platform();\n\nclass Station extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      styleMap: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignContent: \"space-between\",\n        alignItems: \"center\",\n        flexDirection: \"column\",\n        width: \"100%\",\n        height: \"300px\"\n      },\n      isLoadingMap: true,\n      station: DataManager.getStation()\n    };\n  }\n\n  showPanelHeader() {\n    const { history } = this.props;\n\n    return (\n      <PanelHeader\n        left={\n          <HeaderButton onClick={history.goBack}>\n            {osname === IOS ? \"Отмена\" : <Icon24Back />}\n          </HeaderButton>\n        }\n      >\n        {Loc.StationTitle}\n      </PanelHeader>\n    );\n  }\n\n  mapOnLoad = () => {\n    this.setState({ isLoadingMap: false });\n  };\n\n  showMap() {\n    const zoom = 16;\n\n    const mapState = {\n      center: [this.state.station.lat, this.state.station.lng],\n      zoom: zoom\n    };\n\n    const mapOptions = {\n      yandexMapDisablePoiInteractivity: true,\n      suppressMapOpenBlock: true\n    };\n\n    return (\n      <div>\n        {this.state.isLoadingMap && this.showSpinner()}\n        <Map\n          defaultOptions={mapOptions}\n          style={this.state.styleMap}\n          defaultState={mapState}\n          onLoad={this.mapOnLoad}\n        >\n          <Placemark\n            geometry={[this.state.station.lat, this.state.station.lng]}\n            options={{\n              iconLayout: \"default#image\",\n              iconImageHref:\n                \"https://raw.githubusercontent.com/iPagar/donate-blood/master/src/img/heart.png\",\n              iconImageSize: [36, 36],\n              iconImageOffset: [-18, -36]\n            }}\n          />\n          <Placemark\n            geometry={DataManager.getGeo()}\n            options={{\n              preset: \"islands#geolocationIcon\",\n              iconColor: \"#f60808\"\n            }}\n          />\n        </Map>\n      </div>\n    );\n  }\n\n  showSite() {\n    return (\n      <React.Fragment>\n        {this.state.station.site.length > 0 && (\n          <Group title=\"Сайт\">\n            <List>\n              <Cell multiline before={<Icon24Globe />}>\n                <Link\n                  href={\n                    this.state.station.site.includes(\"http\")\n                      ? `${this.state.station.site}`\n                      : `//${this.state.station.site}`\n                  }\n                  target=\"_blank\"\n                >\n                  {this.state.station.site}\n                </Link>\n              </Cell>\n            </List>\n          </Group>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  showEmail() {\n    return (\n      <React.Fragment>\n        {this.state.station.email.length > 0 && (\n          <Group title=\"E-mail\">\n            <List>\n              <Cell multiline before={<Icon24Globe />}>\n                <Link href={this.state.station.site}>\n                  {this.state.station.site}\n                </Link>\n              </Cell>\n            </List>\n          </Group>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  showWorkTime() {\n    return (\n      <React.Fragment>\n        {this.state.station.worktime.length > 0 && (\n          <Group title=\"Время работы\">\n            <List>\n              <Cell multiline before={<Icon24Recent />}>\n                {this.state.station.worktime}\n              </Cell>\n            </List>\n          </Group>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  showTel() {\n    let tels = [];\n    if (this.state.station.phones.length > 0)\n      findNumbers(this.state.station.phones, \"RU\", {\n        v2: true\n      }).map(tel => tels.push(tel.number.formatNational()));\n\n    return (\n      <React.Fragment>\n        {tels.length > 0 && (\n          <Group title=\"Контакты\">\n            <List>\n              {tels.map((tel, i) => (\n                <Cell key={i} before={<Icon24Phone />}>\n                  <Link href={`tel:${tel}`}>{tel}</Link>\n                </Cell>\n              ))}\n            </List>\n          </Group>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  showAddress() {\n    return (\n      <Group>\n        <Header level=\"2\">\n          <div style={{ whiteSpace: \"normal\" }}>{this.state.station.title}</div>\n        </Header>\n        <List>\n          <Cell multiline before={<Icon24Place />}>\n            <Link\n              href={`//maps.yandex.ru/?text=${this.state.station.city.title}, ${\n                this.state.station.address\n              }`}\n            >\n              {this.state.station.address}\n            </Link>\n          </Cell>\n        </List>\n      </Group>\n    );\n  }\n\n  showInfo() {\n    return (\n      <React.Fragment>\n        {this.showAddress()}\n        {this.showWorkTime()}\n        {this.showTel()}\n        {this.showSite()}\n      </React.Fragment>\n    );\n  }\n\n  showSpinner() {\n    return (\n      <div style={this.state.styleMap}>\n        <Spinner size=\"medium\" />\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <View activePanel=\"station\" popout={this.state.popout}>\n        <Panel id=\"station\">\n          {this.showPanelHeader()}\n          {this.showMap()}\n          {this.showInfo()}\n        </Panel>\n      </View>\n    );\n  }\n}\n\nexport default Station;\n","import React from \"react\";\nimport VKConnect from \"@vkontakte/vkui-connect\";\nimport { Root, View } from \"@vkontakte/vkui\";\nimport \"@vkontakte/vkui/dist/vkui.css\";\nimport \"./resources/ui.css\";\nimport { Route, withRouter } from \"react-router-dom\";\nimport \"./app.css\";\n\nimport FindStations from \"./panels/FindStations\";\nimport FindCity from \"./panels/FindCity\";\nimport Station from \"./panels/Station\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { isLoading: false };\n  }\n\n  getTheme() {\n    VKConnect.subscribe(e => {\n      switch (e.detail.type) {\n        case \"VKWebAppUpdateConfig\":\n          let schemeAttribute = document.createAttribute(\"scheme\");\n          schemeAttribute.value = e.detail.data.scheme\n            ? e.detail.data.scheme\n            : \"client_light\";\n          document.body.attributes.setNamedItem(schemeAttribute);\n          break;\n        default:\n          break;\n      }\n    });\n  }\n\n  async setInitialView() {\n    await this.setState({ isLoading: true });\n\n    this.props.history.replace(\"findStations\");\n\n    await this.setState({ isLoading: false });\n  }\n\n  componentDidMount() {\n    this.setInitialView();\n    this.getTheme();\n  }\n\n  render() {\n    const { isLoading } = this.state;\n    const activeView = this.props.location.pathname.slice(1);\n\n    return (\n      <div style={{ width: \"100%\", height: \"100%\" }}>\n        {!isLoading && (\n          <Root activeView={activeView}>\n            <Route id=\"findStations\" component={FindStations} />\n            <Route id=\"station\" component={Station} />\n            <Route id=\"findCity\" component={FindCity} />\n            <Route\n              id=\"findCityNecessarily\"\n              render={() => (\n                <View activePanel=\"findCityPanel\">\n                  <FindCity\n                    id=\"findCityPanel\"\n                    history={this.props.history}\n                    necessarily\n                  />\n                </View>\n              )}\n            />\n          </Root>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default withRouter(App);\n","import \"core-js/es6/map\";\nimport \"core-js/es6/set\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport connect from \"@vkontakte/vkui-connect\";\nimport App from \"./App\";\nimport { HashRouter } from \"react-router-dom\";\nimport { YMaps } from \"react-yandex-maps\";\n\n// Init VK App\nconnect.send(\"VKWebAppInit\", {});\n\nReactDOM.render(\n\t<HashRouter>\n\t\t<YMaps>\n\t\t\t<App />\n\t\t</YMaps>\n\t</HashRouter>,\n\tdocument.getElementById(\"root\")\n);\n"],"sourceRoot":""}